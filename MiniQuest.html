<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Adventure Generator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Tone.js for subtle sound effects -->
    <script src="https://unpkg.com/tone@14.8.49/build/Tone.js"></script>
    <!-- Import new Fonts for contrast -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@800&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* Base Styling & Hyper-Refined Gradient */
        body {
            font-family: 'Nunito', sans-serif;
            /* Deeper, more saturated background gradient (Violet/Indigo core) */
            background: linear-gradient(-45deg, #07021e, #180538, #07021e, #140938);
            background-size: 400% 400%;
            animation: gradientBG 30s ease infinite;
            /* IMPORTANT: Removed overflow: hidden to fix scrolling */
        }
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* --- V11 NEW: Subtle Particle Field Animation --- */
        .particle-field {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            background: rgba(129, 140, 248, 0.5); /* Violet */
            border-radius: 50%;
            animation: glow-particles 20s infinite linear;
            box-shadow: 0 0 5px #818cf8;
            opacity: 0.7;
        }

        @keyframes glow-particles {
            0% { transform: translate(0, 0) scale(1); opacity: 0.7; }
            50% { transform: translate(20vw, 20vh) scale(1.5); opacity: 0.3; }
            100% { transform: translate(0, 0) scale(1); opacity: 0.7; }
        }
        
        /* New Title Font and Stronger Glow */
        #adventure-title span {
            font-family: 'Exo 2', sans-serif;
            letter-spacing: 0.1em; 
            text-shadow: 0 0 18px rgba(167, 139, 250, 0.9); 
        }

        /* Card Animation and Shadows */
        .card-wrapper {
            animation: fadeInUp 0.7s ease-out;
            /* Ultra-high shadow for floating effect */
            box-shadow: 0 0 70px rgba(99, 102, 241, 0.7), 0 35px 70px -17px rgba(0, 0, 0, 0.8);
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        /* Improved Content Transition */
        .content-fade-out { animation: contentFadeOut 0.3s cubic-bezier(0.55, 0.085, 0.68, 0.53) forwards; }
        .content-fade-in { animation: contentFadeIn 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }
        @keyframes contentFadeOut { from { opacity: 1; transform: translateY(0); filter: blur(0); } to { opacity: 0; transform: translateY(-15px); filter: blur(3px); } }
        @keyframes contentFadeIn { from { opacity: 0; transform: translateY(15px); filter: blur(3px); } to { opacity: 1; transform: translateY(0); filter: blur(0); } }

        /* --- ENHANCED LOADING SCREEN STYLING --- */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #07021e; /* Match new BG */
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #fff;
            transition: opacity 0.5s ease-out;
        }
        
        /* New breathing animation for loading text */
        @keyframes breathingGlow {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.03); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        .loading-text-glow {
            text-shadow: 0 0 15px rgba(52, 211, 235, 0.8); /* Neon Cyan Glow */
            color: #67e8f9;
            animation: breathingGlow 3s infinite alternate ease-in-out; /* Apply new animation */
        }
        
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top: 4px solid #67e8f9; /* Neon Cyan */
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .page-wrapper {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start; 
            padding: 3rem 1rem; 
        }

        /* --- Reward Box Pulse & Transition --- */
        .reward-box {
            /* Background: Neon Cyan to Indigo Gradient */
            background: linear-gradient(90deg, #67e8f91a, #67e8f933, #67e8f91a); 
            border: 2px solid #22d3ee66; /* Light Cyan Border */
            box-shadow: 0 0 15px rgba(34, 211, 238, 0.5); /* Cyan glow */
            transition: opacity 0.4s ease-out, transform 0.4s ease-out;
            opacity: 0;
            transform: translateY(20px);
        }
        .reward-box.show {
            opacity: 1;
            transform: translateY(0);
        }
        @keyframes rewardPulse {
            0%, 100% { box-shadow: 0 0 15px rgba(34, 211, 238, 0.5); }
            50% { box-shadow: 0 0 25px rgba(34, 211, 238, 0.8); }
        }
        .reward-box.pulsing {
            animation: rewardPulse 0.5s ease-out 1;
        }
        
        /* Pulsing Button Glow Animation */
        @keyframes pulseGlow {
            0%, 100% {
                box-shadow: 0 0 25px rgba(129, 140, 248, 0.8), 0 8px 15px rgba(0, 0, 0, 0.4);
            }
            50% {
                box-shadow: 0 0 40px rgba(129, 140, 248, 1), 0 8px 15px rgba(0, 0, 0, 0.6);
            }
        }
        
        #new-adventure-btn {
            animation: pulseGlow 4s infinite alternate ease-in-out;
        }
        /* FINAL BUTTON TWEAK */
        #new-adventure-btn:active {
            background-image: linear-gradient(to right, #22d3ee, #06b6d4); /* Neon Cyan press feedback */
            transform: scale(0.97); 
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.8), 0 0 20px #22d3ee;
        }
        #new-adventure-btn:hover {
            box-shadow: inset 0 0 15px rgba(52, 211, 235, 0.4), 0 0 45px rgba(129, 140, 248, 1);
        }

        #new-adventure-btn:disabled {
            animation-play-state: paused;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }

        /* Choice Button Border */
        .choice-button {
            border-color: rgba(255, 255, 255, 0.1) !important;
        }
        .choice-button:hover {
            background-color: rgba(255, 255, 255, 0.25) !important;
            border-color: rgba(52, 211, 235, 0.7) !important; /* Cyan hover border */
        }
        
        /* List Item Text Shadow for better contrast on all content text */
        .list-item-text, #adventure-desc {
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

    </style>
</head>
<body class="text-gray-100 p-4">

    <!-- Particle Field -->
    <div class="particle-field">
        <!-- 5 faint particles with random sizes and durations -->
        <div class="particle" style="width: 3px; height: 3px; top: 10%; left: 80%; animation-duration: 25s; animation-delay: -5s;"></div>
        <div class="particle" style="width: 5px; height: 5px; top: 50%; left: 15%; animation-duration: 18s; animation-delay: -10s;"></div>
        <div class="particle" style="width: 2px; height: 2px; top: 90%; left: 40%; animation-duration: 30s; animation-delay: -15s;"></div>
        <div class="particle" style="width: 4px; height: 4px; top: 25%; left: 50%; animation-duration: 22s; animation-delay: -2s;"></div>
        <div class="particle" style="width: 3px; height: 3px; top: 70%; left: 5%; animation-duration: 27s; animation-delay: -8s;"></div>
    </div>

    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="spinner"></div>
        <!-- NAME CHANGE APPLIED: Removed V11 -->
        <h2 class="text-2xl font-bold mb-2 font-['Exo_2'] loading-text-glow">ADVENTURE ENGINE</h2>
        <p id="loading-status" class="text-md loading-text-glow">Initializing System Cores...</p>
    </div>
    
    <!-- Wrapper to handle vertical centering/scroll -->
    <div class="page-wrapper">
        <!-- Main Card Wrapper -->
        <div class="card-wrapper w-full max-w-lg hidden mx-auto" id="main-content">
            <!-- Ultimate Glass Card -->
            <main class="bg-white/10 backdrop-blur-3xl rounded-3xl p-6 md:p-8 w-full 
                        border border-white/20 
                        border-t-violet-400/90 border-l-violet-400/90 
                        border-r-indigo-700/50 border-b-indigo-700/50
                        shadow-2xl">
                
                <!-- Wrapper for content fade animations -->
                <div id="adventure-content">
                    <!-- Adventure Title (Exo 2 Font) -->
                    <h1 id="adventure-title" class="text-4xl md:text-5xl font-extrabold text-violet-100 mb-4 text-center flex items-center justify-center space-x-3 min-h-[56px] drop-shadow-lg">
                        <span>Initializing...</span>
                    </h1>
                    
                    <!-- Adventure Description -->
                    <p id="adventure-desc" class="text-lg text-violet-200 mb-8 text-center min-h-[48px]"></p>

                    <!-- Adventure Steps/Choices Container -->
                    <div id="adventure-steps" class="space-y-4">
                        <!-- Content is dynamically generated by JavaScript -->
                    </div>

                    <!-- Themed Reward Container -->
                    <div id="adventure-reward" class="reward-box p-4 rounded-xl mt-8 text-cyan-50 shadow-md">
                        <!-- Reward content generated by JavaScript -->
                    </div>
                </div>

                <!-- New Adventure Button -->
                <button id="new-adventure-btn" 
                        class="bg-gradient-to-r from-violet-500 to-indigo-600 hover:from-violet-600 hover:to-indigo-700 
                            text-white font-bold py-4 px-6 rounded-xl mt-10 w-full 
                            transition-all duration-300 transform hover:scale-[1.03] active:scale-98
                            shadow-xl focus:outline-none focus:ring-4 focus:ring-violet-300/50
                            disabled:opacity-50 disabled:cursor-wait">
                    Generate Perfect Adventure
                </button>

            </main>
        </div>
    </div>

    <script>
        // --- TONE.JS SETUP ---
        const reverb = new Tone.Reverb(1.5).toDestination();
        const mainSynth = new Tone.MetalSynth({
            frequency: 200,
            envelope: { attack: 0.005, decay: 0.5, release: 0.2 },
            harmonicity: 5.1,
            modulationIndex: 32,
            resonance: 4000,
            octaves: 1.5,
        }).connect(reverb);
        const choiceSynth = new Tone.PluckSynth({
            attackNoise: 0.8,
            dampening: 4000,
            resonance: 0.9,
            release: 0.1
        }).toDestination();

        const startClick = () => { 
            Tone.context.resume().then(() => { 
                mainSynth.triggerAttackRelease(["C4", "Eb4", "G4"], "0.6s", Tone.now(), 0.8); 
            }); 
        };
        const choiceClick = () => { 
            Tone.context.resume().then(() => { 
                choiceSynth.triggerAttackRelease(["G5", "C6"], "8n"); 
            }); 
        };

        // --- ICONS (Same as previous, using Lucide equivalents) ---
        const storyIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-violet-300 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>`;
        const realIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-violet-300 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7v7l9-11h-7z" /></svg>`;
        const questIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-violet-300 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l5.447 2.724A1 1 0 0021 16.382V5.618a1 1 0 00-1.447-.894L15 7m-6 13v-6m6 6v-6m0-3l-6-3m6 3l6-3m-6 3V7" /></svg>`;

        // --- ADVENTURE BLUEPRINTS (EXPANDED CONTENT V11) ---
        const adventureBlueprints = [
            // --- STORY ---
            { type: 'story', title: "The Temporal Bookmark", description: "You open your favorite book and find a note with tomorrow's date.", reward: "A paradox! You've successfully navigated a time warp. Your prize: you can take a 5-minute break *without* guilt.", storyGraph: { 'start': { text: "The note reads: 'Don't eat the blue one.' You have two identical energy bars on your desk: one red, one blue. What do you do?", choices: [{ text: "Eat the red one", target: "end_red" }, { text: "Eat the blue one, despite the warning", target: "end_blue" }, { text: "Eat neither", target: "end_neither" }] }, 'end_red': { text: "You eat the red bar. It tastes like raspberries and regret. Nothing happens. Mission complete... maybe?", choices: [] }, 'end_blue': { text: "You eat the blue one. It tastes like mint and static electricity. Suddenly, you feel a strong urge to alphabetize your spice rack. You've changed the past, mildly.", choices: [] }, 'end_neither': { text: "You throw the bars away. You don't have time for temporal food games. You maintain the timeline. Victory through caution.", choices: [] } } },
            
            // --- REAL (Total 9) ---
            { type: 'real', title: "The Shadow Puppet Master", description: "You must create three (3) distinct shadow puppets on the wall using only your hands and a light source.", steps: [ "1. Find a lamp or flashlight and face a blank wall.", "2. Shadow 1: The Rabbit (Classic ears, wiggling nose).", "3. Shadow 2: The Flying Bird (Two hands flapping).", "4. Shadow 3: The Wolf/Dog (Profile view, opening jaw).", "5. Give your shadow puppets a one-sentence dramatic performance.", ], reward: "You've earned the title: Master of the Silent Arts. Fact: Shadow puppetry has existed for over 1,000 years." },
            { type: 'real', title: "The Juggling Challenge", description: "Find three small, soft, safe objects (socks, tennis balls, tangerines) and attempt a single successful juggle catch.", steps: [ "1. Gather three items.", "2. Practice the two-ball cascade throw (transferring from hand to hand).", "3. Attempt the three-ball cascade (Throw, Throw, Throw, Catch, Catch, Catch).", "4. Achieve one successful 'Toss-Toss-Catch' sequence.", ], reward: "Juggling is harder than it looks! +1 Dexterity. Even if you failed, the attempt was admirable." },
            { type: 'real', title: "The Compliment Compass", description: "Your mission: write a one-line compliment for the next non-human thing you see (plant, book, piece of art, pet).", steps: [ "1. Look away from your screen.", "2. Identify the next object that catches your eye.", "3. (Example object: 'This blue pen').", "4. Write its compliment: 'You are the most reliable ink-delivery system I have ever known.'", ], reward: "You've spread positive energy into the universe. The object now appreciates you back." },
            { type: 'real', title: "Mindful Water Break", description: "Your quest: drink one full glass of water, focusing only on the sensation of drinking.", steps: [ "1. Get a glass of water.", "2. Sit down, close your eyes (or keep them open).", "3. Notice the temperature of the glass and the water.", "4. Take slow sips, noticing the taste and feeling as you swallow.", "5. Finish the glass. Hydration complete!", ], reward: "A refreshing +10 to Health and Focus. You are now a well-hydrated hero." },
            { type: 'real', title: "The One-Minute Stretch", description: "You feel the creeping fatigue of the sedentary life. Perform a simple, full-body stretch for 60 seconds.", steps: [ "1. Stand up and reach hands to the sky (15 seconds).", "2. Touch your toes (15 seconds).", "3. Perform neck rolls (15 seconds).", "4. Do a chest-opening stretch by clasping your hands behind your back (15 seconds).", ], reward: "Your body alignment score is now maxed! +1 Vitality." },
            { type: 'real', title: "The Scent Memory", description: "Find the strongest smelling item near you (coffee, soap, a spice). Close your eyes and focus on that scent for 10 seconds.", steps: [ "1. Locate your chosen scent source.", "2. Take three slow, deep breaths.", "3. Hold the scent memory and its associated feelings for 10 seconds.", "4. Slowly open your eyes.", ], reward: "Your olfactory senses are heightened! +1 Awareness." },
            { type: 'real', title: "The Symmetry Seeker", description: "Find two identical objects in the room and place them side-by-side to restore balance.", steps: [ "1. Scan your environment for identical items (e.g., two pens, two books, two headphones).", "2. Select the pair you want to move.", "3. Place them deliberately next to each other, creating symmetry.", ], reward: "Balance restored! You've achieved aesthetic harmony. +1 Focus." },
            { type: 'real', title: "The Five Finger Fastener", description: "Tie a knot (any knot: shoelace, simple overhand) in a piece of string, rope, or even a spare headphone wire.", steps: [ "1. Acquire a flexible length of cord.", "2. Perform a simple knot (like an overhand or figure-eight).", "3. Untie the knot immediately.", ], reward: "Dexterity check passed! You've maintained a critical survival skill." },
            { type: 'real', title: "The Nostalgia Trip", description: "Find a photo or object from at least five years ago and look at it for 10 seconds, allowing a positive memory to surface.", steps: [ "1. Locate an item or photo that predates 2020.", "2. Hold it and focus on it for 10 seconds.", "3. Briefly recall a good feeling or memory associated with it.", ], reward: "Time travel successful! You have secured a vital piece of personal history." },
            
            // --- QUEST (Total 18) ---
            { type: 'quest', title: "The Pillow Fort Barrier", description: "Your quest: Build a small, symbolic barrier using pillows and blankets to protect your 'work area' from the forces of distraction.", steps: [ "1. Gather 2-3 pillows and one blanket/towel.", "2. Strategically place them around your chair or desk area.", "3. The barrier must be able to withstand a gentle puff of air.", "4. Declare the area 'Focus Zone, Level 1.'", ], reward: "You've constructed a Fortress of Solitude! The focus is now strong with you." },
            { type: 'quest', title: "The Five Senses Log", description: "Your quest: Write down one thing you can currently Hear, See, Smell, Taste (even just a residual taste), and Feel (touch).", steps: [ "1. Hear: (e.g., traffic outside, air conditioner humming).", "2. See: (e.g., the color of your screen, a crack in the wall).", "3. Smell: (e.g., clean laundry, dust, faint perfume).", "4. Taste: (e.g., mint from toothpaste, coffee residual).", "5. Feel: (e.g., the texture of your clothes, the smooth table).", ], reward: "You are fully present! +5 Mindfulness. This exercise helps reduce stress." },
            { type: 'quest', title: "Future Self Letter", description: "Your quest: Write one short sentence about what you want your future self to remember about today.", steps: [ "1. Grab a piece of paper or open a note app.", "2. Write the date.", "3. Write your sentence (e.g., 'Remember how quiet the morning was,' or 'I finally finished that tricky homework problem.').", "4. Fold it up and put it somewhere safe (like a book or drawer).", ], reward: "A message has been sent through time! Future you will appreciate this moment." },
            { type: 'quest', title: "The Desk Archaeologist", description: "Find three items on your desk that do not belong there, and return them to their proper domain.", steps: [ "1. Locate item 1 (e.g., a dish, a remote, old receipts).", "2. Locate item 2.", "3. Locate item 3.", "4. Successfully transport all three items to their intended resting place.", ], reward: "You've excavated junk! Your area is now 15% more productive." },
            { type: 'quest', title: "The Tidy Cable Hydra", description: "Your quest: Tame one wild, visible cable (phone charger, headphone cord, etc.) and wrap it neatly.", steps: [ "1. Identify the messiest cable near you.", "2. Unplug it, detangle it completely.", "3. Wrap it neatly using a tie, rubber band, or Velcro.", "4. Re-plug the now-tamed cable.", ], reward: "The clutter monster has been defeated! Electrical efficiency improved." },
            { type: 'quest', title: "The Five Second Rule", description: "You have 5 seconds to choose the next song you will listen to, or the next window you will close. Choose quickly!", steps: [ "1. Decide if you are choosing a song or a window.", "2. Start a 5-second countdown.", "3. Make the choice before time runs out.", "4. Execute the choice (play the song or close the window).", ], reward: "Decisive action rewarded! You've successfully embraced immediacy." },
            { type: 'quest', title: "The Water Bottle Whisperer", description: "Your quest: Hold your water bottle/glass and thank it silently for providing hydration.", steps: [ "1. Hold your hydration source.", "2. Acknowledge the importance of water.", "3. Whisper 'Thank you' (or think it) to the vessel.", "4. Take a grateful sip.", ], reward: "A moment of gratitudeâ€”pure and simple. Your karma is now 100% purified." },
            { type: 'quest', title: "The Cloud Photographer", description: "If there are clouds, take a moment to find the most interesting cloud shape and give it a name.", steps: [ "1. Look out a window or go outside (if safe).", "2. Locate the most impressive cloud formation.", "3. Give it a dramatic name (e.g., 'The Flying Walrus of Despair').", "4. Tell someone (or just write down) the cloud's name.", ], reward: "You've harnessed the power of imagination! The sky is now your canvas." },
            { type: 'quest', title: "The Silence Scribe", description: "For 30 seconds, close your eyes and listen only to the ambient silence. Write down the first thought that comes to mind.", steps: [ "1. Set a timer for 30 seconds.", "2. Close your eyes and clear your mind.", "3. When the timer goes off, write down the very first thought you had.", "4. Reflect on how easy or hard that was.", ], reward: "You've captured a fragment of pure thought! +1 Insight." },
            { type: 'quest', title: "The Inbox Zero Mini-Boss", description: "Your quest: Delete or archive the last 5 non-essential emails in your inbox.", steps: [ "1. Open your inbox (the source of digital chaos).", "2. Identify 5 pieces of spam, newsletters, or ancient notifications.", "3. Dispatch them (delete/archive).", "4. Enjoy the brief, sweet taste of digital cleanliness.", ], reward: "The digital horde has been thinned! Congratulations on your mini-purge." },
            { type: 'quest', title: "The Laughter Librarian", description: "Find the funniest, shortest clip/meme/photo you know and let yourself laugh out loud for 5 seconds.", steps: [ "1. Quickly locate your chosen source of humor.", "2. Watch or view it.", "3. Force a good, hearty laugh (it helps even if it's fake at first!).", "4. Close the source and return to work feeling refreshed.", ], reward: "Emotional status: Recharged. You've earned a mood boost power-up." },
            { type: 'quest', title: "The Mini-Inventory Check", description: "Find and put away three non-food items that belong in the kitchen but aren't there now.", steps: [ "1. Identify three misplaced items that belong in the kitchen.", "2. Retrieve them (e.g., a mug in your office, a bowl in the living room).", "3. Return all three items to their proper kitchen location.", ], reward: "Chaos reduced. You are one step closer to ultimate domestic efficiency." },
            { type: 'quest', title: "The Noise Counter", description: "Spend 15 seconds silently counting the number of distinct human-made sounds you hear (cars, typing, music, etc.).", steps: [ "1. Close your eyes and start a 15-second mental timer.", "2. Focus intently on every sound.", "3. Count how many distinct sources you can identify (e.g., three: fan, keyboard, distant truck).", "4. Write down the final number.", ], reward: "You've sharpened your auditory awareness. The environment can no longer surprise you." },
            { type: 'quest', title: "The Micro-Budget Planner", description: "Identify one recurring small expense (snack, coffee, subscription) you can skip for one day this week.", steps: [ "1. Name one small, optional item you often buy.", "2. Make a mental note to skip purchasing it tomorrow.", "3. If you already skipped it, count this as mission successful!", ], reward: "A small saving is still a win! +1 Financial Discipline." },
            { type: 'quest', title: "The Wall Gazing Meditation", description: "Pick a spot on a blank wall. Stare at it for 60 seconds without blinking or moving your eyes.", steps: [ "1. Find a featureless spot on a wall.", "2. Plant your focus there.", "3. Hold your gaze for one full minute.", "4. Blink when complete and enjoy the relief.", ], reward: "You have exhibited supreme will over your ocular nerves. +1 Willpower." },
            { type: 'quest', title: "The App Organizer", description: "Delete one unused app or reorganize a screen of apps on your phone or computer.", steps: [ "1. Open your least favorite screen of apps.", "2. Delete one app you haven't used in three months, OR move 3 apps into one folder.", "3. Observe the cleaner screen.", ], reward: "Digital entropy is temporarily defeated. Enjoy the clarity." },
            { type: 'quest', title: "The Goal Fragmenter", description: "Write down one large goal you have, and then write down the very first tiny action required to start it.", steps: [ "1. Write down a scary, big goal (e.g., 'Write a book').", "2. Below it, write the *first 5 minute action* (e.g., 'Find a blank document').", "3. You are not required to do the action, only define it.", ], reward: "The journey of a thousand miles begins with a perfectly defined first step. Strategy unlocked." },
            { type: 'quest', title: "The Temperature Dial", description: "Adjust the main thermostat or nearest AC/heating unit by exactly $1^\circ$ (up or down).", steps: [ "1. Locate the nearest temperature control device.", "2. Decide whether to increase or decrease the temperature by $1^\circ$.", "3. Execute the small change.", ], reward: "You are the master of microclimates. Comfort level adjusted." },
            { type: 'quest', title: "The Vertical View", description: "Find an object that is clearly **above** your current eye level and look at it closely for 5 seconds.", steps: [ "1. Locate a high object (e.g., a smoke detector, a top shelf item).", "2. Tilt your head back and focus only on that object for 5 seconds.", "3. Observe its details.", ], reward: "Perspective shift achieved. You have seen the high ground." },
            { type: 'quest', title: "The Color Hunt", description: "Find and briefly touch three distinct objects of a single, unusual color (e.g., neon green, turquoise, or orange).", steps: [ "1. Choose your color.", "2. Find item 1 and touch it.", "3. Find item 2 and touch it.", "4. Find item 3 and touch it.", ], reward: "Chromatic awareness increased! The world is now more vibrant." },
            { type: 'quest', title: "The Alphabet Navigator", description: "Spell out your first name by pointing to or touching items on your desk or in your immediate area.", steps: [ "1. Choose the first letter of your name.", "2. Find an object that starts with that letter (or that looks like the letter).", "3. Repeat for every letter in your name.", ], reward: "Your environment has become a personalized, interactive alphabet soup." },
            { type: 'quest', title: "The Five Step Detour", description: "Stand up. Take five full steps backward. Pause. Then take five full steps forward.", steps: [ "1. Stand and check for obstacles.", "2. Take five deliberate steps backward.", "3. Pause for a breath.", "4. Take five deliberate steps forward.", ], reward: "Forward and backward momentum maintained. You are surprisingly good at geometry." },
            { type: 'quest', title: "The Doorway Stretch", description: "Find a doorway, place your arms on the frame, and perform a chest/shoulder stretch for 15 seconds.", steps: [ "1. Go to a doorway or sturdy wall corner.", "2. Place your forearms on the frame.", "3. Gently lean in until you feel a comfortable stretch in your chest and shoulders.", "4. Hold for 15 seconds.", ], reward: "Posture alignment complete. Your shoulders thank you." },
            { type: 'quest', title: "The Sound Map", description: "Take 10 seconds to listen to the environment, and mentally place the sounds you hear on a tiny map around you.", steps: [ "1. Close your eyes and listen intently for 10 seconds.", "2. Identify three main sound sources.", "3. Mentally (or physically) plot their location relative to you.", ], reward: "You've successfully mapped your acoustic reality. Audio precision +1." },
            { type: 'quest', title: "The Quick Clean", description: "Identify one dirty spot, smudge, or piece of lint in your immediate view and clean it/remove it.", steps: [ "1. Find the target micro-mess (e.g., finger smudge on the screen, a crumb).", "2. Clean/remove it.", "3. Observe the instant improvement in clarity.", ], reward: "Micro-cleaning successful. The universe is slightly tidier because of you." },
            { type: 'quest', title: "The Next Page Commitment", description: "Find the nearest book or magazine. Read the first full sentence on the next page.", steps: [ "1. Locate the nearest physical reading material.", "2. Turn to the next clean page.", "3. Read only the first complete sentence out loud or in your head.", ], reward: "A tiny glimpse into a different world. Knowledge transfer initiated." },
            { type: 'quest', title: "The Hydration Log", description: "Check the current time, and decide when you will drink your next full glass of water. Write down that time.", steps: [ "1. Check the time (e.g., 10:30 AM).", "2. Set a reasonable time in the future for your next drink (e.g., 11:15 AM).", "3. Write down the future time (on paper or a note app).", ], reward: "Future hydration secured. You are proactive in your well-being." },
            { type: 'quest', title: "The Hand Switch", description: "Type the next 5 words you need to write using only your non-dominant hand.", steps: [ "1. Identify your non-dominant hand (usually the one you don't write with).", "2. Find where you left off typing.", "3. Type the next five words using *only* that hand.", "4. Resume normal typing.", ], reward: "Fine motor skills challenge achieved! +1 Neuroplasticity." },
        ];

        // --- DOM Elements ---
        const titleEl = document.getElementById('adventure-title');
        const descEl = document.getElementById('adventure-desc');
        const stepsEl = document.getElementById('adventure-steps');
        const rewardEl = document.getElementById('adventure-reward');
        const newAdventureBtn = document.getElementById('new-adventure-btn');
        const adventureContentEl = document.getElementById('adventure-content');
        const loadingScreenEl = document.getElementById('loading-screen');
        const mainContentEl = document.getElementById('main-content');
        const loadingStatusEl = document.getElementById('loading-status');

        // --- Core Functions ---
        function showReward(rewardText) {
            rewardEl.innerHTML = `<strong class="font-bold text-cyan-300">Reward Achieved:</strong> ${rewardText}`;
            setTimeout(() => {
                rewardEl.classList.add('show');
                // V10: Trigger pulse animation
                rewardEl.classList.add('pulsing');
                setTimeout(() => {
                    rewardEl.classList.remove('pulsing');
                }, 500);
            }, 50); 
        }

        function renderStaticAdventure(adventure) {
            stepsEl.innerHTML = ''; 
            const stepsList = document.createElement('ul');
            stepsList.className = 'space-y-3 list-none';
            
            adventure.steps.forEach(stepText => {
                const li = document.createElement('li');
                li.className = 'bg-white/10 border border-white/20 p-4 rounded-xl flex items-start shadow-inner transition-all duration-200 hover:bg-white/25';
                li.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-cyan-400 mr-3 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <span class="text-gray-50 text-base list-item-text">${stepText}</span>`;
                stepsList.appendChild(li);
            });
            
            stepsEl.appendChild(stepsList);
            showReward(adventure.reward);
        }

        function renderStoryNode(adventure, nodeKey) {
            choiceClick(); 
            
            const node = adventure.storyGraph[nodeKey];
            stepsEl.innerHTML = ''; 
            
            rewardEl.classList.remove('show');
            rewardEl.classList.remove('pulsing');
            setTimeout(() => rewardEl.innerHTML = '', 400); 

            const textEl = document.createElement('p');
            textEl.className = 'text-xl text-white italic mb-6 text-center bg-white/5 p-4 rounded-lg border border-white/10 list-item-text';
            textEl.textContent = node.text;
            stepsEl.appendChild(textEl);

            if (node.choices && node.choices.length > 0) {
                const choicesContainer = document.createElement('div');
                choicesContainer.className = 'space-y-4';
                
                node.choices.forEach(choice => {
                    const button = document.createElement('button');
                    button.className = 'choice-button bg-white/10 border text-white font-semibold py-4 px-5 rounded-xl w-full text-left transition-all duration-200 transform hover:border-white/40 flex justify-between items-center shadow-lg active:scale-98';
                    button.innerHTML = `
                        <span>${choice.text}</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-cyan-200 ml-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                        </svg>
                    `;
                    button.onclick = () => renderStoryNode(adventure, choice.target);
                    choicesContainer.appendChild(button);
                });
                
                stepsEl.appendChild(choicesContainer);
            } else {
                // This is an ending node
                showReward(adventure.reward);
            }
        }

        function generateAdventure() {
            const adventure = adventureBlueprints[Math.floor(Math.random() * adventureBlueprints.length)];
            let icon;
            if (adventure.type === 'story') icon = storyIcon;
            else if (adventure.type === 'real') icon = realIcon;
            else icon = questIcon;

            titleEl.innerHTML = `${icon} <span class="tracking-widest">${adventure.title}</span>`;
            descEl.textContent = adventure.description;

            rewardEl.classList.remove('show');
            rewardEl.classList.remove('pulsing');
            rewardEl.innerHTML = '';
            
            if (adventure.type === 'real' || adventure.type === 'quest') {
                renderStaticAdventure(adventure);
            } else if (adventure.type === 'story') {
                renderStoryNode(adventure, 'start');
            }
        }

        function onNewAdventureClick() {
            startClick(); 
            newAdventureBtn.disabled = true;
            newAdventureBtn.textContent = 'Generating Adventure...';

            adventureContentEl.classList.add('content-fade-out');
            
            setTimeout(() => {
                generateAdventure();

                adventureContentEl.classList.remove('content-fade-out');
                adventureContentEl.classList.add('content-fade-in');

                newAdventureBtn.disabled = false;
                newAdventureBtn.textContent = 'Generate Perfect Adventure';

                setTimeout(() => {
                    adventureContentEl.classList.remove('content-fade-in');
                }, 400); 

            }, 300);
        }
        
        // --- Dynamic Loading Status ---
        const statusMessages = [
            "Establishing Neural Link...",
            "Calibrating Adventure Matrix...",
            "Compiling Reality Assets...",
            "Optimizing Focus Protocols...",
            "Calculating Next Best Action...",
            "Finalizing Configuration..."
        ];

        let statusIndex = 0;
        let statusInterval;

        function updateLoadingStatus() {
            loadingStatusEl.textContent = statusMessages[statusIndex];
            statusIndex = (statusIndex + 1) % statusMessages.length;
        }

        // --- Run on Page Load ---
        document.addEventListener('DOMContentLoaded', () => {
            updateLoadingStatus(); 
            statusInterval = setInterval(updateLoadingStatus, 500); 

            setTimeout(() => {
                clearInterval(statusInterval); 
                loadingStatusEl.textContent = "Reality Stream Established. Ready."; 

                setTimeout(() => {
                    loadingScreenEl.style.opacity = 0;
                    setTimeout(() => {
                        loadingScreenEl.style.display = 'none';
                        mainContentEl.classList.remove('hidden');
                        
                        generateAdventure();
                        adventureContentEl.classList.add('content-fade-in');
                        setTimeout(() => {
                            adventureContentEl.classList.remove('content-fade-in');
                        }, 400);
                    }, 500); 
                }, 500); 
            }, 2500); 
        });
        
        // --- Attach button click event ---
        newAdventureBtn.addEventListener('click', onNewAdventureClick);

    </script>
</body>
</html>


